test2 = ifelse(is.na(Fragment2), 2, 0)) %>%
ungroup() %>%
arrange(parent_folder,locus) %>%
filter(test != 0 | test2 != 0)
View(data_imputed)
View(data_imputed)
data_imputed <- filtered %>%  group_by(parent_folder,locus) %>%
mutate(Fragment = ifelse(is.na(Fragment), mean(Fragment, na.rm = TRUE), Fragment)) %>%
group_by(locus) %>%
mutate(Fragment = ifelse(is.na(Fragment), mean(Fragment, na.rm = TRUE), Fragment)) %>%
ungroup()
data_imputed <- filtered %>%  group_by(parent_folder,locus) %>%
mutate(Fragment = ifelse(is.na(Fragment), mean(Fragment, na.rm = TRUE), Fragment)) %>%
group_by(locus) %>%
mutate(Fragment = ifelse(is.na(Fragment), mean(Fragment, na.rm = TRUE), Fragment)) %>%
group_by(parent_folder,locus) %>%
mutate(allele = row_number())
data_imputed <- filtered %>%  group_by(parent_folder,locus) %>%
mutate(Fragment = ifelse(is.na(Fragment), mean(Fragment, na.rm = TRUE), Fragment)) %>%
group_by(locus) %>%
mutate(Fragment = ifelse(is.na(Fragment), mean(Fragment, na.rm = TRUE), Fragment)) %>%
group_by(parent_folder,locus, file_id) %>%
mutate(allele = row_number())
View(data_imputed)
pivot_wider(id_cols = c(parent_folder, locus, file_id, allele), names_from = locus, values_from = Fragment)
data_imputed <- filtered %>%  group_by(parent_folder,locus) %>%
mutate(Fragment = ifelse(is.na(Fragment), mean(Fragment, na.rm = TRUE), Fragment)) %>%
group_by(locus) %>%
mutate(Fragment = ifelse(is.na(Fragment), mean(Fragment, na.rm = TRUE), Fragment)) %>%
group_by(parent_folder,locus, file_id) %>%
mutate(allele = row_number()) %>%
pivot_wider(id_cols = c(parent_folder, locus, file_id, allele), names_from = locus, values_from = Fragment)
data_imputed <- filtered %>%  group_by(parent_folder,locus) %>%
mutate(Fragment = ifelse(is.na(Fragment), mean(Fragment, na.rm = TRUE), Fragment)) %>%
group_by(locus) %>%
mutate(Fragment = ifelse(is.na(Fragment), mean(Fragment, na.rm = TRUE), Fragment)) %>%
group_by(parent_folder,locus, file_id) %>%
mutate(allele = row_number()) %>%
pivot_wider(id_cols = c(parent_folder, file_id, allele), names_from = locus, values_from = Fragment)
data_imputed <- filtered %>%  group_by(parent_folder,locus) %>%
mutate(Fragment = ifelse(is.na(Fragment), mean(Fragment, na.rm = TRUE), Fragment)) %>%
group_by(locus) %>%
mutate(Fragment = ifelse(is.na(Fragment), mean(Fragment, na.rm = TRUE), Fragment)) %>%
group_by(parent_folder,locus, file_id) %>%
mutate(allele = row_number()) %>%
pivot_wider(id_cols = c(parent_folder, file_id, allele), names_from = locus, values_from = Fragment) %>%
arrange(parent_folder,file_id,allele)
data_imputed <- filtered %>%  group_by(parent_folder,locus) %>%
mutate(Fragment = ifelse(is.na(Fragment), mean(Fragment, na.rm = TRUE), Fragment)) %>%
group_by(locus) %>%
mutate(Fragment = ifelse(is.na(Fragment), mean(Fragment, na.rm = TRUE), Fragment)) %>%
group_by(parent_folder,locus, file_id) %>%
mutate(allele = row_number()) %>%
pivot_wider(id_cols = c(parent_folder, file_id, allele), names_from = locus, values_from = Fragment) %>%
arrange(parent_folder,file_id)
data_imputed <- filtered %>%  group_by(parent_folder,locus) %>%
mutate(Fragment = ifelse(is.na(Fragment), mean(Fragment, na.rm = TRUE), Fragment)) %>%
group_by(locus) %>%
mutate(Fragment = ifelse(is.na(Fragment), mean(Fragment, na.rm = TRUE), Fragment)) %>%
group_by(parent_folder,locus, file_id) %>%
mutate(allele = row_number()) %>%
pivot_wider(id_cols = c(parent_folder, file_id, allele), names_from = locus, values_from = Fragment) %>%
arrange(parent_folder,file_id)
View(data_imputed)
# Perform PCA
pca <- princomp(data_noNA[, -c(1,2,3)])
summary(pca)
# Visualize the clustering found by PCA
cbind(data.frame(parent_folder = data_noNA$parent_folder), as.data.frame(pca$scores)) %>%
ggplot() +
geom_point(aes(x = Comp.1, y = Comp.2, color = parent_folder))
# Perform PCA
pca <- princomp(data_imputed[, -c(1,2,3)])
summary(pca)
# Visualize the clustering found by PCA
cbind(data.frame(parent_folder = data_noNA$parent_folder), as.data.frame(pca$scores)) %>%
ggplot() +
geom_point(aes(x = Comp.1, y = Comp.2, color = parent_folder))
# Visualize the clustering found by PCA
cbind(data.frame(parent_folder = fata_imputed$parent_folder), as.data.frame(pca$scores)) %>%
ggplot() +
geom_point(aes(x = Comp.1, y = Comp.2, color = parent_folder))
# Perform PCA
pca <- princomp(data_imputed[, -c(1,2,3)])
summary(pca)
# Visualize the clustering found by PCA
cbind(data.frame(parent_folder = fata_imputed$parent_folder), as.data.frame(pca$scores)) %>%
ggplot() +
geom_point(aes(x = Comp.1, y = Comp.2, color = parent_folder))
# Visualize the clustering found by PCA
cbind(data.frame(parent_folder = data_imputed$parent_folder), as.data.frame(pca$scores)) %>%
ggplot() +
geom_point(aes(x = Comp.1, y = Comp.2, color = parent_folder))
data <- read_sheet("https://docs.google.com/spreadsheets/d/1CByNQeZh3ansO2f79Ruw4plWsgiLUBaQ7FnNL134_go/edit?usp=sharing", sheet = 3,range = "A1:O655")
data %>% pivot_longer(cols = starts_with("Loc"), names_to = "locus", values_to = "allele") %>%
mutate(color = str_extract(locus, "\\w{2}$")) %>%
ggplot(aes(x = allele, fill = locus))+
geom_histogram(aes(y = ..density..), alpha = 0.5, position = "identity", binwidth = 5)+
geom_density(alpha = 0.3)+
facet_wrap(~color, scales = "free_x")+
scale_fill_viridis_d()+
scale_x_continuous(breaks = seq(0,350,20))
data %>% pivot_longer(cols = starts_with("Loc"), names_to = "locus", values_to = "allele") %>%
mutate(color = str_extract(locus, "\\w{2}$")) %>%
ggplot(aes(x = allele, fill = locus))+
geom_histogram(aes(y = ..density..), alpha = 0.5, position = "identity", binwidth = 5)+
geom_density(alpha = 0.3)+
facet_wrap(~color, scales = "free_x")+
scale_fill_viridis_d()+
scale_x_continuous(breaks = seq(0,350,20))
data %>% pivot_longer(cols = starts_with("Loc"), names_to = "locus", values_to = "allele") %>%
mutate(color = str_extract(locus, "\\w{2}$")) %>%
ggplot(aes(x = allele, fill = locus))+
geom_histogram(aes(y = ..density..), alpha = 0.5, position = "identity", binwidth = 5)+
geom_density(alpha = 0.3)+
facet_wrap(~color, scales = "free_x")+
scale_fill_viridis_d()+
scale_x_continuous(breaks = seq(0,350,20))
filtered %>% group_by(locus)
trunc_new %>% group_by(locus)
filtered %>%
ungroup() %>%
mutate(trunc = round(Fragment)) %>%
group_by(locus) %>%
summarise(n_alelos = n())
filtered %>%
ungroup() %>%
mutate(trunc = round(Fragment)) %>%
group_by(locus)
filtered %>%
ungroup() %>%
mutate(trunc = round(Fragment)) %>%
group_by(locus,trunc) %>%
summarise(n_alelos = n())
filtered %>%
ungroup() %>%
mutate(trunc = round(Fragment)) %>%
group_by(locus,trunc) %>%
summarise(freq = n())
filtered %>%
ungroup() %>%
mutate(trunc = round(Fragment)) %>%
group_by(locus,trunc) %>%
summarise(freq = n()) %>%
group_by(locus) %>%
mutate(riq = n())
filtered %>%
ungroup() %>%
mutate(trunc = round(Fragment)) %>%
group_by(locus,trunc) %>%
summarise(freq = n()) %>%
group_by(locus) %>%
summarise(riq = n())
trunc_new %>%
group_by(locus) %>%
summarise(riq = n())
trunc_old %>%
group_by(locus) %>%
summarise(riq = n())
nAllele_old <- trunc_old %>%
group_by(locus) %>%
summarise(riq = n())
nAllele_new <- trunc_new %>%
group_by(locus) %>%
summarise(riq = n())
left_join(nAllele_new,nAllele_old, by = "locus")
nAllele_new <- trunc_new %>%
group_by(locus) %>%
summarise(riq_new = n())
nAllele_old <- trunc_old %>%
group_by(locus) %>%
summarise(riq_old = n())
left_join(nAllele_new,nAllele_old, by = "locus")
left_join(nAllele_new,nAllele_old, by = "locus") %>% kable()
left_join(nAllele_new,nAllele_old, by = "locus")
left_join(nAllele_new,nAllele_old, by = "locus") %>% knitr::kable()
left_join(nAllele_new,nAllele_old, by = "locus") %>% knitr::kable(col.names = c("Locus","Número de alelos SZA", "Número de alelos Herm"))
left_join(nAllele_new,nAllele_old, by = "locus") %>% knitr::kable(col.names = c("Locus","Número de alelos nuevo", "Número de alelos Herm"))
left_join(nAllele_new,nAllele_old, by = "locus") %>% knitr::kable(col.names = c("Locus","Número de\nalelos nuevo", "Número de\nalelos Herm"))
left_join(nAllele_new,nAllele_old, by = "locus") %>% knitr::kable(col.names = c("Locus","Número de\nalelos nuevo", "Número de\nalelos Herm"))
left_join(nAllele_new,nAllele_old, by = "locus") %>% knitr::kable(col.names = c("Locus","Número de alelos nuevo", "Número de alelos Herm"))
left_join(nAllele_new,nAllele_old, by = "locus") %>% knitr::kable(col.names = c("Locus","Número de\\nalelos nuevo", "Número de alelos Herm"), align = "center", )
left_join(nAllele_new,nAllele_old, by = "locus") %>% knitr::kable(col.names = c("Locus","Número de\\nalelos nuevo", "Número de alelos Herm"), align = "c", )
left_join(nAllele_new,nAllele_old, by = "locus") %>% knitr::kable(col.names = c("Locus","Número de\\nalelos nuevo", "Número de alelos Herm"), align = "c")
left_join(nAllele_new,nAllele_old, by = "locus") %>% knitr::kable(col.names = c("Locus","Número de\\n alelos nuevo", "Número de alelos Herm"), align = "c")
left_join(nAllele_new,nAllele_old, by = "locus") %>% knitr::kable(col.names = c("Locus","Número de\nalelos nuevo", "Número de alelos Herm"), align = "c")
left_join(nAllele_new,nAllele_old, by = "locus") %>% knitr::kable(col.names = c("Locus","Número de alelos nuevo", "Número de alelos Herm"), align = "c")
left_join(nAllele_new,nAllele_old, by = "locus") %>% knitr::kable(col.names = c("Locus","Número de alelos nuevo", "Número de alelos Herm"), align = "c")%>%
kable_paper("hover", full_width = F)
nAllele_new <- trunc_new %>%
group_by(locus) %>%
summarise(riq_new = n())
nAllele_old <- trunc_old %>%
group_by(locus) %>%
summarise(riq_old = n())
left_join(nAllele_new,nAllele_old, by = "locus") %>% knitr::kable(col.names = c("Locus","Número de alelos nuevo", "Número de alelos Herm"), align = "c")%>%
kable_paper("hover", full_width = F)
library(kableExtra)
left_join(nAllele_new,nAllele_old, by = "locus") %>% knitr::kable(col.names = c("Locus","Número de alelos nuevo", "Número de alelos Herm"), align = "c")%>%
kable_paper("hover", full_width = F)
left_join(nAllele_new,nAllele_old, by = "locus") %>% knitr::kable(col.names = c("Locus","Número de alelos nuevo", "Número de alelos Hermilo"), align = "c")%>%
kable_paper("hover", full_width = F)
left_join(nAllele_new,nAllele_old, by = "locus") %>% knitr::kable(col.names = c("Locus","Número de alelos nuevo", "Número de alelos Hermilo"), align = "c")%>%
kable_material("hover", full_width = F)
left_join(nAllele_new,nAllele_old, by = "locus") %>% knitr::kable(col.names = c("Locus","Número de alelos nuevo", "Número de alelos Hermilo"), align = "c")%>%
kable_styling(bootstrap_options = c("striped", "hover"), full_width = F)
1+1
library(googlesheets4)
ss <- "https://docs.google.com/spreadsheets/d/1n5Bg_eepdqBClRHSqIKalo1hRqhp4-WSRNBrMxtxZuQ/edit?usp=sharing"
tax <- read_sheet(ss,sheet = "taxonomia")
View(tax)
tax <- read_sheet(ss,sheet = "taxonomia")
tax <- read_sheet(ss,sheet = "taxonomia")
reg <- read_sheet(ss,sheet = "registros")
reg <- read_sheet(ss,sheet = "registros")
sitios <- read_sheet(ss,sheet = "sitios")
View(sitios)
View(reg)
left_join(reg,tax,by="id_sp_orig")
library(tidyverse)
left_join(reg,tax,by="id_sp_orig")
union <- left_join(reg,tax,by="id_sp_orig")
data <- read_sheet("https://docs.google.com/spreadsheets/d/1dymbG-dIjeXGbZNJ_-4p44JDXZDvfKNcnfdRCtS4Tu0/edit?usp=sharing", col_types = 'ddcccccccddddcccccDcc')
library(tidyverse)
library(googlesheets4)
data <- read_sheet("https://docs.google.com/spreadsheets/d/1dymbG-dIjeXGbZNJ_-4p44JDXZDvfKNcnfdRCtS4Tu0/edit?usp=sharing", col_types = 'ddcccccccddddcccccDcc')
View(data)
conn <- dbConnect(
drv = RMariaDB::MariaDB(),
username = "sofia",
password = "MDB!2019#", # contraseña mounstrito
host = "localhost",
port = 3306,
dbname = "ejemplares_BN"
)
library(googlesheets4)
library(RMariaDB)
library(tidyverse)
install.packages("RMariaDB")
conn <- dbConnect(
drv = RMariaDB::MariaDB(),
username = "sofia",
password = "MDB!2019#", # contraseña mounstrito
host = "localhost",
port = 3306,
dbname = "ejemplares_BN"
)
library(RMariaDB)
library(tidyverse)
conn <- dbConnect(
drv = RMariaDB::MariaDB(),
username = "sofia",
password = "MDB!2019#", # contraseña mounstrito
host = "localhost",
port = 3306,
dbname = "ejemplares_BN"
)
conn <- dbConnect(
drv = RMariaDB::MariaDB(),
username = "sofia",
password = "sofia", # contraseña laptop sofia
host = "localhost",
port = 3306,
dbname = "ejemplares_BN"
)
datos <- dbSendQuery(conn, "SELECT *
FROM ejemplares e
left join individuos i on e.id_individuo = i.id_individuo
left JOIN estados edo on i.id_estado = edo.id_estado
LEFT JOIN fotos_ejemplares fe on e.id_ejemplar = fe.id_ejemplar
WHERE ISNULL(e.localizacion)
ORDER BY i.id_individuo, e.id_ejemplar ") %>% dbFetch()
datos
datos <- dbSendQuery(conn, "SELECT e.id_ejemplar,
e.id_individuo,
e.localizacion,
e.codigo_colecta,
i.id_individuo,
edo.estado,
i.fecha,
fe.id_foto,
i.latitud,
i.longitud
FROM ejemplares e
left join individuos i on e.id_individuo = i.id_individuo
left JOIN estados edo on i.id_estado = edo.id_estado
LEFT JOIN fotos_ejemplares fe on e.id_ejemplar = fe.id_ejemplar
WHERE ISNULL(e.localizacion)
ORDER BY i.id_individuo, e.id_ejemplar ") %>% dbFetch()
datos
datos <- dbSendQuery(conn, "SELECT e.id_ejemplar,
e.id_individuo,
e.localizacion,
e.codigo_colecta,
edo.estado,
i.fecha,
fe.id_foto,
i.latitud,
i.longitud
FROM ejemplares e
left join individuos i on e.id_individuo = i.id_individuo
left JOIN estados edo on i.id_estado = edo.id_estado
LEFT JOIN fotos_ejemplares fe on e.id_ejemplar = fe.id_ejemplar
WHERE ISNULL(e.localizacion)
ORDER BY i.id_individuo, e.id_ejemplar ") %>% dbFetch()
datos
datosDB <- dbSendQuery(conn, "SELECT e.id_ejemplar,
e.id_individuo,
e.localizacion,
e.codigo_colecta,
edo.estado,
i.fecha,
fe.id_foto,
i.latitud,
i.longitud
FROM ejemplares e
left join individuos i on e.id_individuo = i.id_individuo
left JOIN estados edo on i.id_estado = edo.id_estado
LEFT JOIN fotos_ejemplares fe on e.id_ejemplar = fe.id_ejemplar
WHERE ISNULL(e.localizacion)
ORDER BY i.id_individuo, e.id_ejemplar ") %>% dbFetch()
datos <- read_sheet(ss = "https://docs.google.com/spreadsheets/d/1IloUmr7sYNDFX1yjt5BgXKrP3ty4bCYTsPQnTyMYEUg/edit?usp=sharing", sheet = 1)
datos
datos <- read_sheet(ss = "https://docs.google.com/spreadsheets/d/1IloUmr7sYNDFX1yjt5BgXKrP3ty4bCYTsPQnTyMYEUg/edit?usp=sharing", sheet = 1) %>% select(id_individuo, Localizacion, Fecha_colecta, id_foto_haz, id_foto)
datos
datos <- read_sheet(ss = "https://docs.google.com/spreadsheets/d/1IloUmr7sYNDFX1yjt5BgXKrP3ty4bCYTsPQnTyMYEUg/edit?usp=sharing", sheet = 1) %>% select(id_individuo, Localizacion, as.Date(Fecha_colecta), id_foto_haz, id_foto)
datos <- read_sheet(ss = "https://docs.google.com/spreadsheets/d/1IloUmr7sYNDFX1yjt5BgXKrP3ty4bCYTsPQnTyMYEUg/edit?usp=sharing", sheet = 1) %>% select(id_individuo, Localizacion, Fecha_colecta, id_foto_haz, id_foto) %>% mutate(Fecha_colecta = as.Date(Fecha_colecta))
datos
datos <- read_sheet(ss = "https://docs.google.com/spreadsheets/d/1IloUmr7sYNDFX1yjt5BgXKrP3ty4bCYTsPQnTyMYEUg/edit?usp=sharing", sheet = 1) %>%
select(id_individuo, Localizacion, Fecha_colecta, id_foto_haz, id_foto) %>%
mutate(Fecha_colecta = as.Date(Fecha_colecta)) %>%
pivot_longer(cols = starts_with("id_foto"), names_to = "temp", values_to = "id_foto")
datos
datos <- read_sheet(ss = "https://docs.google.com/spreadsheets/d/1IloUmr7sYNDFX1yjt5BgXKrP3ty4bCYTsPQnTyMYEUg/edit?usp=sharing", sheet = 1) %>%
select(id_individuo, Localizacion, Fecha_colecta, id_foto_haz, id_foto) %>%
mutate(Fecha_colecta = as.Date(Fecha_colecta)) %>%
pivot_longer(cols = starts_with("id_foto"), names_to = "temp", values_to = "id_foto") %>%
mutate(posicion = ifelse(temp == "id_foto_haz",1,2),.before = id_foto)
datos
datos <- read_sheet(ss = "https://docs.google.com/spreadsheets/d/1IloUmr7sYNDFX1yjt5BgXKrP3ty4bCYTsPQnTyMYEUg/edit?usp=sharing", sheet = 1) %>%
select(id_individuo, Localizacion, Fecha_colecta, id_foto_haz, id_foto) %>%
mutate(Fecha_colecta = as.Date(Fecha_colecta)) %>%
pivot_longer(cols = starts_with("id_foto"), names_to = "temp", values_to = "id_foto") %>%
mutate(posicion = ifelse(temp == "id_foto_haz",1,2),.before = id_foto) %>%
select(-temp)
datos <- read_sheet(ss = "https://docs.google.com/spreadsheets/d/1IloUmr7sYNDFX1yjt5BgXKrP3ty4bCYTsPQnTyMYEUg/edit?usp=sharing", sheet = 1) %>%
select(id_individuo, Localizacion, Fecha_colecta, id_foto_haz, id_foto) %>%
mutate(Fecha_colecta = as.Date(Fecha_colecta)) %>%
pivot_longer(cols = starts_with("id_foto"), names_to = "temp", values_to = "id_foto") %>%
mutate(posicion = ifelse(temp == "id_foto_haz",1,2),.before = id_foto) %>%
select(-temp)
datos
datos <- read_sheet(ss = "https://docs.google.com/spreadsheets/d/1IloUmr7sYNDFX1yjt5BgXKrP3ty4bCYTsPQnTyMYEUg/edit?usp=sharing", sheet = 1) %>%
select(id_individuo, Localizacion, Fecha_colecta, id_foto_haz, id_foto) %>%
mutate(Fecha_colecta = as.Date(Fecha_colecta)) %>%
pivot_longer(cols = starts_with("id_foto"), names_to = "temp", values_to = "id_foto") %>%
mutate(posicion = ifelse(temp == "id_foto_haz",1,2),.before = id_foto) %>%
select(-temp) %>%
mutate(id_ejemplar = seq(1163,1360))
datos <- read_sheet(ss = "https://docs.google.com/spreadsheets/d/1IloUmr7sYNDFX1yjt5BgXKrP3ty4bCYTsPQnTyMYEUg/edit?usp=sharing", sheet = 1) %>%
select(id_individuo, Localizacion, Fecha_colecta, id_foto_haz, id_foto) %>%
mutate(Fecha_colecta = as.Date(Fecha_colecta)) %>%
pivot_longer(cols = starts_with("id_foto"), names_to = "temp", values_to = "id_foto") %>%
mutate(posicion = ifelse(temp == "id_foto_haz",1,2),.before = id_foto) %>%
select(-temp) #%>%
View(datos)
View(datosDB)
datos <- read_sheet(ss = "https://docs.google.com/spreadsheets/d/1IloUmr7sYNDFX1yjt5BgXKrP3ty4bCYTsPQnTyMYEUg/edit?usp=sharing", sheet = 1) %>%
select(id_individuo, Localizacion, Fecha_colecta, id_foto_haz, id_foto) %>%
mutate(Fecha_colecta = as.Date(Fecha_colecta)) %>%
pivot_longer(cols = starts_with("id_foto"), names_to = "temp", values_to = "id_foto") %>%
mutate(posicion = ifelse(temp == "id_foto_haz",1,2),.before = id_foto, id_foto = str_remove(id_foto,"_\\d$")) %>%
select(-temp) #%>%
datos
datos_sin_posicion <- datos %>%
select(-posicion) %>%
distinct()
datos_sin_posicion
datos_sin_posicion <- datos %>%
select(-posicion) %>%
distinct()
View(datos_sin_posicion)
datos_sin_posicion <- datos %>%
select(-posicion) %>%
distinct() %>%
mutate(ejemplar = str_remove(id_foto, "MXCHH"))
datos_sin_posicion
datos_sin_posicion <- datos %>%
select(-posicion) %>%
distinct() %>%
mutate(id_ejemplar = str_remove(id_foto, "MXCHH"))
datos_sin_posicion <- datos %>%
select(-posicion) %>%
distinct() %>%
mutate(id_ejemplar = str_remove(id_foto, "\\w*"))
View(datos_sin_posicion)
datos_sin_posicion <- datos %>%
select(-posicion) %>%
distinct() %>%
mutate(id_ejemplar = str_remove(id_foto, "[A-Z]{1,}"))
View(datos_sin_posicion)
datos_sin_posicion <- datos %>%
select(-posicion) %>%
distinct() %>%
mutate(id_ejemplar = str_remove(id_foto, "[A-Z]{1,}")) %>%
mutate(id_ejemplar = ifelse(id_individuo=>694,id_ejemplar+1))
View(datos_sin_posicion)
datos_sin_posicion <- datos %>%
select(-posicion) %>%
distinct() %>%
mutate(id_ejemplar = str_remove(id_foto, "[A-Z]{1,}")) #%>%
datos_sin_posicion <- datos %>%
select(-posicion) %>%
distinct() %>%
mutate(id_ejemplar = str_remove(id_foto, "[A-Z]{1,}")) %>%
arrange(id_individuo,id_ejemplar)#%>%
View(datos_sin_posicion)
datos_sin_posicion <- datos %>%
select(-posicion) %>%
distinct() %>%
mutate(id_ejemplar = str_remove(id_foto, "[A-Z]{1,}")) %>%
arrange(id_individuo,id_ejemplar) %>%
mutate(id_ejemplar = ifelse(id_individuo=>694,id_ejemplar+2))
datos_sin_posicion <- datos %>%
select(-posicion) %>%
distinct() %>%
mutate(id_ejemplar = str_remove(id_foto, "[A-Z]{1,}")) %>%
arrange(id_individuo,id_ejemplar) %>%
mutate(id_ejemplar = ifelse(id_individuo =>694 ,id_ejemplar+2))
datos_sin_posicion <- datos %>%
select(-posicion) %>%
distinct() %>%
mutate(id_ejemplar = str_remove(id_foto, "[A-Z]{1,}")) %>%
arrange(id_individuo,id_ejemplar) %>%
mutate(id_ejemplar = ifelse(id_individuo >= 694 ,id_ejemplar+2))
datos_sin_posicion <- datos %>%
select(-posicion) %>%
distinct() %>%
mutate(id_ejemplar = str_remove(id_foto, "[A-Z]{1,}")) %>%
arrange(id_individuo,id_ejemplar) %>%
mutate(id_ejemplar = ifelse(id_individuo >= 694 ,as.numeric(id_ejemplar)+2))
datos_sin_posicion <- datos %>%
select(-posicion) %>%
distinct() %>%
mutate(id_ejemplar = str_remove(id_foto, "[A-Z]{1,}")) %>%
arrange(id_individuo,id_ejemplar) %>%
mutate(id_ejemplar = ifelse(id_individuo >= 694 ,as.numeric(id_ejemplar)+2,id_ejemplar))
View(datos_sin_posicion)
left_join(datosDB,datos_sin_posicion, by = c("id_individuo" = "id_individuo","id_ejemplar" = "id_ejemplar"))
datos_sin_posicion <- datos %>%
select(-posicion) %>%
distinct() %>%
mutate(id_ejemplar = str_remove(id_foto, "[A-Z]{1,}")) %>%
arrange(id_individuo,id_ejemplar) %>%
mutate(id_ejemplar = as.numeric(ifelse(id_individuo >= 694 ,as.numeric(id_ejemplar)+2,id_ejemplar)))
left_join(datosDB,datos_sin_posicion, by = c("id_individuo" = "id_individuo","id_ejemplar" = "id_ejemplar"))
datosDB <- select(datosDB, -c(localizacion,id_foto,fecha))
datos_sin_posicion <- datos %>%
select(-posicion) %>%
distinct() %>%
mutate(id_ejemplar = str_remove(id_foto, "[A-Z]{1,}")) %>%
arrange(id_individuo,id_ejemplar) %>%
mutate(id_ejemplar = as.numeric(ifelse(id_individuo >= 694 ,as.numeric(id_ejemplar)+2,id_ejemplar)))
datos_sin_posicion <- datos %>%
select(-posicion) %>%
distinct() %>%
mutate(id_ejemplar = str_remove(id_foto, "[A-Z]{1,}")) %>%
arrange(id_individuo,id_ejemplar) %>%
mutate(id_ejemplar = as.numeric(ifelse(id_individuo >= 694 ,as.numeric(id_ejemplar)+2,id_ejemplar)))
left_join(datosDB,datos_sin_posicion, by = c("id_individuo" = "id_individuo","id_ejemplar" = "id_ejemplar"))
write.csv(final_data,file = "datos_faltantes_cajas12a14.csv")
final_data <- left_join(datosDB,datos_sin_posicion, by = c("id_individuo" = "id_individuo","id_ejemplar" = "id_ejemplar"))
write.csv(final_data,file = "datos_faltantes_cajas12a14.csv")
getwd()
datos_sin_posicion <- datos %>%
distinct() %>%
mutate(id_ejemplar = str_remove(id_foto, "[A-Z]{1,}")) %>%
arrange(id_individuo,id_ejemplar) %>%
mutate(id_ejemplar = as.numeric(ifelse(id_individuo >= 694 ,as.numeric(id_ejemplar)+2,id_ejemplar)))
datos_sin_posicion <- datos %>%
distinct() %>%
mutate(id_ejemplar = str_remove(id_foto, "[A-Z]{1,}")) %>%
arrange(id_individuo,id_ejemplar) %>%
mutate(id_ejemplar = as.numeric(ifelse(id_individuo >= 694 ,as.numeric(id_ejemplar)+2,id_ejemplar)))
datos_sin_posicion
select(datos_sin_posicion, id_ejemplar,posicion,id_foto)
select(datos_sin_posicion, id_ejemplar,posicion,id_foto) %>% dbWriteTable(conn, value = ., name = "fotos_ejemplares", header = T, row.names= F, append = T)
?`dbWriteTable,MariaDBConnection,character,character-method`
?dbWriteTable
ind <- read_sheet(ss, sheet = 1)
library(tidyverse)
library(googlesheets4)
ind <- read_sheet(ss, sheet = 1)
ss = "https://docs.google.com/spreadsheets/d/121j3-WTRLWDTDmYH-bZ9eTLDdUvtPrmcqY4eLixgz50/edit?usp=sharing"
ind <- read_sheet(ss, sheet = 1)
setwd("~/Documents/Laboratorio_BioNeo/ejemplares_BN/bin/symbiota")
tax <- read.csv("../../data/catalogoTaxonomico/dwca-SNIB-CS008-v1.16/occurrence.txt")
tax <- read.table("../../data/catalogoTaxonomico/dwca-SNIB-CS008-v1.16/occurrence.txt",sep = '\t', header = T)
tax <- read.table("../../data/catalogoTaxonomico/dwca-SNIB-CS008-v1.16/occurrence.txt", header = T)
tax <- read.table("../../data/catalogoTaxonomico/dwca-SNIB-CS008-v1.16/occurrence.txt", header = T, sep = "  ")
tax <- read.table("../../data/catalogoTaxonomico/dwca-SNIB-CS008-v1.16/occurrence.txt", header = T, sep = "  ")
tax <- read.table("../../data/catalogoTaxonomico/dwca-SNIB-CS008-v1.16/occurrence.txt", header = T, sep = "\t")
tax <- read.table("../../data/catalogoTaxonomico/dwca-SNIB-CS008-v1.16/occurrence.txt", sep = "\t")
tax <- read.csv("../../data/catalogoTaxonomico/dwca-SNIB-CS008-v1.16/occurrence.txt")
tax <- read.csv("../../data/catalogoTaxonomico/dwca-SNIB-CS008-v1.16/occurrence.csv")
tax <- read.csv("../../data/catalogoTaxonomico/dwca-SNIB-CS008-v1.16/occurrence.csv",sep = ";")
tax
tax <- read.csv("../../data/catalogoTaxonomico/dwca-SNIB-CS008-v1.16/occurrence.csv",sep = "\t")
tax
View(tax)
ind <- read_sheet(ss, sheet = 1, skip = 1)
ind <- read_sheet(ss, sheet = 1, skip = 1, col_types = 'c')
